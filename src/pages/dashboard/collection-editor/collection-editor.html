<template>
  <main if.bind="!user">
    <section>
      <div class="container">
        <h3>You have to be signed in to see your collections.</h3>
      </div>
    </section>
  </main>
  <main if.bind="user">
    <!-- collection list-->
    <section class="collections">
      <div class="container">
        <!-- top section-->
        <div class="topsection">
          <!-- label-->
          <div class="sectionlabel">
            <div class="bold" t="summary:collections">COLLECTIONS</div>
          </div>
          <div class="import-wrap">
            <a href="javascript:void(0)" class="import" click.delegate="newCollection()">
              <span class="plus"></span>
              <span class="text">New Collection</span>
            </a>
          </div>
        </div>
        <div class="campaignlist" if.bind="collections.length>0">
          <!-- entry-->
          <div class="entries row" ref="grid">
            <div class="entry col-md-4 ${col.dbId}" repeat.for="col of collections">
              <a route-href="route: collection-edit; params.bind: { colid: col.dbId, lang: loc }">
                <div class="thumbs">
                  <div class="thumbs-images thumbs-count-${col.absMedia.length}">
                    <img repeat.for="med of col.absMedia" src.bind="med"
                      onError="this.src='/img/assets/img/ui/ic-noimage.png'" />
                  </div>
                  <div class="action">
                    <h3><b>Edit Records</b></h3>
                  </div>
                </div>
                <!-- detail-->
                <div class="detail">
                  <!-- count-->
                  <div class="count">
                    ${col.entryCount}<span t="summary:items">ITEMS</span>
                  </div>
                  <!-- title-->
                  <div class="desc">
                    <div class="title">${col.title[loc] ? col.title[loc] : col.title.default}</div>
                    <div class="owner"><span t="summary:by">Curated by</span> ${col.creatorName}</div>
                  </div>
                </div>

                <ul class="itemaction">
                  <li>
                    <a data-toggle="tooltip" click.delegate="deleteCollection(col)" data-placement="top"
                      title="Delete collection" class="delete"><img class="editicon"
                        src="/img/assets/img/ui/ic-delete.png" /></i></a>
                  </li>
                  <li>
                    <a data-toggle="tooltip" click.delegate="editCollection(col)" data-placement="top"
                      title="Edit Collection"><img class="editicon" src="/img/assets/img/ui/ic-edit.png" /></a>
                  </li>
                </ul>
              </a>

            </div>
          </div>
          <!-- more-->
          <div class="loadmore">
            <a href="#" show.bind="!loading && more" click.delegate="loadMore()" t="app:loadmore">LOAD MORE</a>
            <div class="more"><i show.bind="loading" class="fa fa-spinner fa-pulse"></i></div>
          </div>
        </div>
        <div class="more"><i show.bind="loading" class="fa fa-spinner fa-pulse"></i></div>

        <div if.bind="collections.length===0 && !loading">
          <h5>You have created no collections. Try to add a new one or import one from Europeana</h5>
        </div>
      </div>
    </section>
    <section>
      <compose view-model="widgets/newcollection/newcollection"
        model.bind="{'collection' : editableCollection, 'type': edittype, 'lang': loc}"></compose>
    </section>
  </main>
</template>
